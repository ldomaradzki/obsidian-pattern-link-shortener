/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var g=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var L=Object.prototype.hasOwnProperty;var y=(s,t)=>{for(var e in t)g(s,e,{get:t[e],enumerable:!0})},C=(s,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of x(t))!L.call(s,a)&&a!==e&&g(s,a,{get:()=>t[a],enumerable:!(n=S(t,a))||n.enumerable});return s};var D=s=>C(g({},"__esModule",{value:!0}),s);var N={};y(N,{default:()=>h});module.exports=D(N);var R=require("obsidian");function I(s){try{let t=s.replace(/\+/g," ");return decodeURIComponent(t)}catch(t){return s.replace(/\+/g," ")}}function F(s){return s.replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*")}function w(s){return s.replace(/[^a-zA-Z0-9.*\-\/]/g,"")}function P(s){if(!s||s.trim()==="")return"Pattern cannot be empty";try{return new RegExp(s),null}catch(t){return t instanceof Error?t.message:"Invalid regex pattern"}}function b(s){return!s||s.trim()===""?"Template cannot be empty":!s.includes("${url}")&&!/\$\{\d+\}/.test(s)?"Template must include ${url} or at least one capture group (${1}, ${2}, etc.)":null}function f(s,t){if(!t.enabled||!t.domainPattern||!t.pathPattern)return null;let e=F(t.domainPattern);if(!new RegExp(`^https?:\\/\\/${e}`).test(s))return null;let a=new RegExp(`^(https?:\\/\\/${e})${t.pathPattern}(\\?.*)?$`),r=s.match(a);if(!r)return null;let o=t.outputTemplate;o=o.replace(/\$\{url\}/g,s);let E=r[1].replace(/^https?:\/\//,"");o=o.replace(/\$\{domain\}/g,E);for(let u=1;u<=9;u++){let l=u+1,p=r[l]!==void 0?r[l]:"",c=I(p);o=o.replace(new RegExp(`\\$\\{${u}\\}`,"g"),c)}return o}function T(s,t){if(typeof s!="string"||!s.trim()||/\s/.test(s))return null;for(let e of t){let n=f(s,e);if(n!==null)return n}return null}var v={jira:{name:"JIRA Issues",domainPattern:"*.atlassian.net",pathPattern:"\\/.*\\/([A-Z][A-Z0-9]*-\\d+)",outputTemplate:"[${1}](${url})",description:"Formats JIRA issue links to show issue key (e.g., DEV-123)",isPreset:!0},jiraSelfHosted:{name:"JIRA (Self-Hosted)",domainPattern:"jira.example.com",pathPattern:"\\/.*\\/([A-Z][A-Z0-9]*-\\d+)",outputTemplate:"[${1}](${url})",description:"For self-hosted JIRA instances. Update the domain pattern to match your server.",isPreset:!0},confluence:{name:"Confluence Pages",domainPattern:"*.atlassian.net",pathPattern:"\\/wiki\\/spaces\\/[^\\/]+\\/pages\\/\\d+\\/([^?]+)",outputTemplate:"[${1}](${url})",description:"Formats Confluence links to show page title from URL",isPreset:!0},confluenceSelfHosted:{name:"Confluence (Self-Hosted)",domainPattern:"confluence.example.com",pathPattern:"\\/wiki\\/spaces\\/[^\\/]+\\/pages\\/\\d+\\/([^?]+)",outputTemplate:"[${1}](${url})",description:"For self-hosted Confluence instances. Update the domain pattern.",isPreset:!0},gitlabIssue:{name:"GitLab Issues",domainPattern:"gitlab.com",pathPattern:"\\/([^\\/]+\\/[^\\/]+)\\/-\\/issues\\/(\\d+)",outputTemplate:"[${1}#${2}](${url})",description:"Formats GitLab issue links (e.g., group/project#123)",isPreset:!0},gitlabMergeRequest:{name:"GitLab Merge Requests",domainPattern:"gitlab.com",pathPattern:"\\/([^\\/]+\\/[^\\/]+)\\/-\\/merge_requests\\/(\\d+)",outputTemplate:"[${1}!${2}](${url})",description:"Formats GitLab MR links (e.g., group/project!123)",isPreset:!0},gitlabSelfHosted:{name:"GitLab (Self-Hosted)",domainPattern:"gitlab.example.com",pathPattern:"\\/([^\\/]+\\/[^\\/]+)\\/-\\/(issues|merge_requests)\\/(\\d+)",outputTemplate:"[${1}#${3}](${url})",description:"For self-hosted GitLab. Update domain pattern. Uses # for both issues and MRs.",isPreset:!0},github:{name:"GitHub Issues/PRs",domainPattern:"github.com",pathPattern:"\\/([^\\/]+\\/[^\\/]+)\\/(issues|pull)\\/(\\d+)",outputTemplate:"[${1}#${3}](${url})",description:"Formats GitHub issue and PR links (e.g., owner/repo#123)",isPreset:!0},bitbucketPr:{name:"Bitbucket PRs",domainPattern:"bitbucket.org",pathPattern:"\\/([^\\/]+\\/[^\\/]+)\\/pull-requests\\/(\\d+)",outputTemplate:"[${1}#${2}](${url})",description:"Formats Bitbucket pull request links (e.g., team/repo#123)",isPreset:!0},bitbucketIssue:{name:"Bitbucket Issues",domainPattern:"bitbucket.org",pathPattern:"\\/([^\\/]+\\/[^\\/]+)\\/issues\\/(\\d+)",outputTemplate:"[${1}#${2}](${url})",description:"Formats Bitbucket issue links (e.g., team/repo#45)",isPreset:!0},azureDevOpsWorkItem:{name:"Azure DevOps Work Items",domainPattern:"dev.azure.com",pathPattern:"\\/[^\\/]+\\/[^\\/]+\\/_workitems\\/edit\\/(\\d+)",outputTemplate:"[#${1}](${url})",description:"Formats Azure DevOps work item links (e.g., #1234)",isPreset:!0},azureDevOpsPr:{name:"Azure DevOps PRs",domainPattern:"dev.azure.com",pathPattern:"\\/[^\\/]+\\/[^\\/]+\\/_git\\/[^\\/]+\\/pullrequest\\/(\\d+)",outputTemplate:"[PR-${1}](${url})",description:"Formats Azure DevOps pull request links (e.g., PR-56)",isPreset:!0},trello:{name:"Trello Cards",domainPattern:"trello.com",pathPattern:"\\/c\\/[^\\/]+\\/([^?]+)",outputTemplate:"[${1}](${url})",description:"Formats Trello card links to show card title",isPreset:!0},linear:{name:"Linear Issues",domainPattern:"linear.app",pathPattern:"\\/[^\\/]+\\/issue\\/([A-Z]+-\\d+)",outputTemplate:"[${1}](${url})",description:"Formats Linear issue links (e.g., TEAM-123)",isPreset:!0},notion:{name:"Notion Pages",domainPattern:"notion.so",pathPattern:"\\/([^-]+-[^-]+-[a-f0-9]+)",outputTemplate:"[${1}](${url})",description:"Formats Notion page links to show page title",isPreset:!0},figma:{name:"Figma Files",domainPattern:"figma.com",pathPattern:"\\/file\\/[^\\/]+\\/([^?]+)",outputTemplate:"[${1}](${url})",description:"Formats Figma file links to show design name",isPreset:!0},sentry:{name:"Sentry Issues",domainPattern:"sentry.io",pathPattern:"\\/organizations\\/[^\\/]+\\/issues\\/(\\d+)",outputTemplate:"[SENTRY-${1}](${url})",description:"Formats Sentry issue links (e.g., SENTRY-123)",isPreset:!0},stackoverflow:{name:"Stack Overflow",domainPattern:"stackoverflow.com",pathPattern:"\\/questions\\/\\d+\\/([^?]+)",outputTemplate:"[SO: ${1}](${url})",description:"Formats Stack Overflow question links",isPreset:!0},npm:{name:"npm Packages",domainPattern:"npmjs.com",pathPattern:"\\/package\\/([^?]+)",outputTemplate:"[npm: ${1}](${url})",description:"Formats npm package links (e.g., npm: lodash)",isPreset:!0}};function k(){return`pattern_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function d(s,t){let e=v[s];if(!e)throw new Error(`Unknown preset: ${s}`);return{id:k(),enabled:!0,...e,...t}}var i=require("obsidian");var m=class extends i.PluginSettingTab{constructor(t,e){super(t,e),this.plugin=e}display(){let{containerEl:t}=this;t.empty(),t.addClass("pattern-link-shortener-settings"),t.createEl("h2",{text:"Pattern Link Shortener"}),new i.Setting(t).setName("Link patterns").setDesc("Patterns are evaluated in order. First match wins. Drag handles coming soon - use arrows to reorder.").addButton(n=>n.setButtonText("+ Add pattern").setCta().onClick(()=>this.openPatternModal())).addDropdown(n=>{n.addOption("","Add from preset..."),Object.entries(v).forEach(([a,r])=>{n.addOption(a,r.name)}),n.onChange(async a=>{if(a){let r=d(a);this.plugin.settings.patterns.push(r),await this.plugin.saveSettings(),n.setValue(""),this.display()}})});let e=t.createDiv({cls:"pattern-list"});this.plugin.settings.patterns.length===0?e.createEl("p",{text:"No patterns configured. Add a pattern or choose from presets above.",cls:"pattern-empty-state"}):this.plugin.settings.patterns.forEach((n,a)=>{this.renderPatternItem(e,n,a)})}renderPatternItem(t,e,n){let a=new i.Setting(t).setClass("pattern-item").setName(e.name).setDesc(e.domainPattern+(e.enabled?"":" (disabled)"));a.addToggle(r=>r.setValue(e.enabled).setTooltip(e.enabled?"Disable pattern":"Enable pattern").onChange(async o=>{e.enabled=o,await this.plugin.saveSettings(),this.display()})),n>0&&a.addExtraButton(r=>r.setIcon("arrow-up").setTooltip("Move up (higher priority)").onClick(async()=>{await this.swapPatterns(n,n-1)})),n<this.plugin.settings.patterns.length-1&&a.addExtraButton(r=>r.setIcon("arrow-down").setTooltip("Move down (lower priority)").onClick(async()=>{await this.swapPatterns(n,n+1)})),a.addExtraButton(r=>r.setIcon("pencil").setTooltip("Edit pattern").onClick(()=>this.openPatternModal(e))),a.addExtraButton(r=>r.setIcon("trash").setTooltip("Delete pattern").onClick(async()=>{this.plugin.settings.patterns.splice(n,1),await this.plugin.saveSettings(),this.display()}))}async swapPatterns(t,e){let n=this.plugin.settings.patterns;[n[t],n[e]]=[n[e],n[t]],await this.plugin.saveSettings(),this.display()}openPatternModal(t){new $(this.app,t,async e=>{if(t){let n=this.plugin.settings.patterns.findIndex(a=>a.id===t.id);n>=0&&(this.plugin.settings.patterns[n]=e)}else this.plugin.settings.patterns.push(e);await this.plugin.saveSettings(),this.display()}).open()}},$=class extends i.Modal{constructor(t,e,n){super(t),this.onSave=n,this.isNew=!e,this.pattern=e?{...e}:{id:k(),name:"New Pattern",enabled:!0,domainPattern:"",pathPattern:"",outputTemplate:"[${1}](${url})"}}onOpen(){let{contentEl:t}=this;t.empty(),t.addClass("pattern-edit-modal"),t.createEl("h2",{text:this.isNew?"Add Pattern":`Edit: ${this.pattern.name}`}),new i.Setting(t).setName("Name").setDesc("Display name for this pattern").addText(l=>l.setPlaceholder("My Pattern").setValue(this.pattern.name).onChange(p=>this.pattern.name=p)),new i.Setting(t).setName("Domain pattern").setDesc("Use * as wildcard. Examples: *.atlassian.net, jira.company.com, company.com/jira").addText(l=>l.setPlaceholder("*.example.com").setValue(this.pattern.domainPattern).onChange(p=>this.pattern.domainPattern=w(p)));let e=new i.Setting(t).setName("Path pattern (regex)").setDesc("Regex to match URL path after domain. Use () for capture groups."),n=t.createDiv({cls:"validation-message"});e.addTextArea(l=>{l.setPlaceholder("\\/browse\\/([A-Z]+-\\d+)").setValue(this.pattern.pathPattern).onChange(p=>{this.pattern.pathPattern=p;let c=P(p);c?(n.textContent=c,n.addClass("error")):(n.textContent="Valid pattern",n.removeClass("error")),this.updateTestResult()}),l.inputEl.rows=2,l.inputEl.addClass("pattern-textarea")}),new i.Setting(t).setName("Output template").setDesc("Use ${url} for full URL, ${1}, ${2}, etc. for capture groups, ${domain} for domain").addText(l=>l.setPlaceholder("[${1}](${url})").setValue(this.pattern.outputTemplate).onChange(p=>{this.pattern.outputTemplate=p,this.updateTestResult()}));let a=t.createDiv({cls:"pattern-test-section"});a.createEl("h4",{text:"Test your pattern"});let r=new i.Setting(a).setName("Test URL").setDesc("Paste a URL to test the pattern");this.testInput=a.createEl("input",{type:"text",placeholder:"https://example.com/browse/TEST-123",cls:"pattern-test-input"}),this.testInput.addEventListener("input",()=>this.updateTestResult()),this.testResultEl=a.createDiv({cls:"pattern-test-result"}),this.testResultEl.textContent="Enter a URL above to test",new i.Setting(t).setName("Description (optional)").setDesc("Notes about this pattern for your reference").addText(l=>l.setPlaceholder("For company JIRA instance").setValue(this.pattern.description||"").onChange(p=>this.pattern.description=p||void 0));let o=t.createDiv({cls:"modal-button-container"});o.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close()),o.createEl("button",{text:"Save",cls:"mod-cta"}).addEventListener("click",()=>this.savePattern())}updateTestResult(){if(!this.testInput||!this.testResultEl)return;let t=this.testInput.value.trim();if(!t){this.testResultEl.textContent="Enter a URL above to test",this.testResultEl.removeClass("success"),this.testResultEl.removeClass("error");return}try{let e=f(t,this.pattern);e?(this.testResultEl.textContent=`Result: ${e}`,this.testResultEl.addClass("success"),this.testResultEl.removeClass("error")):(this.testResultEl.textContent="No match - check domain and path pattern",this.testResultEl.addClass("error"),this.testResultEl.removeClass("success"))}catch(e){this.testResultEl.textContent=`Error: ${e instanceof Error?e.message:"Invalid pattern"}`,this.testResultEl.addClass("error"),this.testResultEl.removeClass("success")}}savePattern(){if(!this.pattern.name.trim()){new i.Notice("Name is required");return}if(!this.pattern.domainPattern.trim()){new i.Notice("Domain pattern is required");return}let t=P(this.pattern.pathPattern);if(t){new i.Notice(`Invalid path pattern: ${t}`);return}let e=b(this.pattern.outputTemplate);if(e){new i.Notice(`Invalid template: ${e}`);return}this.onSave(this.pattern),this.close()}onClose(){this.contentEl.empty()}};function A(){return{version:2,patterns:[d("jira",{enabled:!0})]}}var h=class extends R.Plugin{async onload(){await this.loadSettings(),this.addSettingTab(new m(this.app,this)),console.log("Pattern Link Shortener plugin loaded"),this.registerEvent(this.app.workspace.on("editor-paste",(t,e,n)=>{var o;let a=(o=t.clipboardData)==null?void 0:o.getData("text/plain");if(!a)return;let r=T(a,this.settings.patterns);r&&(t.preventDefault(),e.replaceSelection(r))}))}async loadSettings(){let t=await this.loadData();this.settings=Object.assign({},A(),t)}async saveSettings(){await this.saveData(this.settings)}};
